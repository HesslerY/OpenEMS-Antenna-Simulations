%%% User tunables

%% base_priority and offset: chassis for the board to sit in.
% base priority: if the board displaces the model of the chassis or the other way around.
base_priority=0;

% offset on the whole layout to locate it relative to the simulation origin
offset.x = 0.0000;
offset.y = 0.0000;
offset.z = 0;

% void is the material used for: fill holes, cutouts in substrate, etc
void.name = 'AIR';
void.epsilon = 1.000000;
void.mue = 1.000000;
% void.kappa = kappa;
% void.sigma = sigma;

% how many points should be used to describe the round end of traces.
kludge.segments = 10;


%%% Board mesh, part 2
z_bottom_copper=1.5000
mesh.y=[0.0000 0.4970 0.9940 1.4910 1.9879 2.4849 2.9819 3.4789 3.9759 4.4729 4.9698 5.1198 5.1198 5.2692 5.4186 5.5680 5.7173 5.8667 6.0161 6.1655 6.3148 6.4642 6.6136 6.7630 6.9123 7.0617 7.2111 7.3605 7.5098 7.5098 7.5598 7.6598 7.6598 7.7098 7.7098 7.8591 8.0084 8.1576 8.3069 8.4561 8.6054 8.7547 8.9039 9.0532 9.2024 9.3517 9.5010 9.6502 9.7995 9.9487 10.0980 10.2473 10.3965 10.5458 10.6950 10.8443 10.9936 11.1428 11.2921 11.4413 11.5906 11.7399 11.8891 12.0384 12.1876 12.3369 12.4862 12.6354 12.7847 12.9339 13.0832 13.2325 13.3817 13.5310 13.6802 13.8295 13.9788 14.1280 14.2773 14.4265 14.5758 14.7251 14.8743 15.0236 15.1728 15.3221 15.4714 15.6206 15.7699 15.9191 16.0684 16.2177 16.3669 16.5162 16.6654 16.8147 16.9640 17.1132 17.2625 17.4117 17.5610 17.7103 17.8595 18.0088 18.1580 18.3073 18.4566 18.6058 18.7551 18.9043 19.0536 19.2029 19.3521 19.5014 19.6506 19.7999 19.9492 20.0984 20.2477 20.3969 20.5462 20.6955 20.8447 20.9940 21.1432 21.2925 21.4418 21.5910 21.7403 21.8895 22.0388 22.1881 22.3373 22.4866 22.6358 22.7851 22.9344 23.0836 23.2329 23.3821 23.5314 23.6807 23.8299 23.9792 24.1284 24.2777 24.4270 24.5762 24.7255 24.8747 25.0240 25.1733 25.3225 25.4718 25.6210 25.7703 25.9196 26.0688 26.2181 26.3673 26.5166 26.6659 26.8151 26.9644 27.1136 27.2629 27.4122 27.5614 27.7107 27.8599 28.0092 28.1585 28.3077 28.4570 28.6062 28.7555 28.9048 29.0540 29.2033 29.3525 29.5018 29.6511 29.8003 29.9496 30.0988 30.2481 30.3974 30.5466 30.6959 30.8451 30.9944 31.1437 31.2929 31.4422 31.5914 31.7407 31.8900 32.0392 32.1885 32.3377 32.4870 32.6363 32.7855 32.9348 32.9598 32.9598 33.0848 33.1098 33.1098 33.1098 33.2592 33.4086 33.5580 33.7073 33.8567 34.0061 34.1555 34.3048 34.4542 34.6036 34.7530 34.9023 35.0517 35.2011 35.3505 35.4998 35.6498 35.6498 35.7849 35.9199 36.0549 36.1899 36.3249 36.4599 36.5949 36.7300 36.8650 37.0000 37.0000 37.1485 37.2971 37.4456 37.5942 37.7427 37.8913 38.0398 38.1898 38.1898 38.6889 39.1879 39.6869 40.1859 40.6849 41.1839 41.6830 42.1820 42.6810 43.1800];
mesh.x=[7.0360 6.7693 6.3860 5.8860 0.0000 0.4905 0.9810 1.4715 1.9620 2.4525 2.9430 3.4335 3.9240 4.4145 4.9050 5.3955 7.1860 7.3360 7.3360 7.4709 7.6058 7.7407 7.8756 8.0104 8.1453 8.2802 8.4151 8.5500 8.5500 8.6862 8.8224 8.9587 9.0949 9.2311 9.3673 9.5036 9.6398 9.7760 9.9530 10.1300 10.1300 10.2735 10.4171 10.5606 10.7041 10.8476 10.9912 11.1347 11.2782 11.4218 11.5653 11.7088 11.8523 11.9959 12.1394 12.2829 12.4265 12.5700 12.7200 12.7200 12.8609 13.0018 13.1428 13.2837 13.4246 13.5655 13.7065 13.8474 13.9883 14.1292 14.2702 14.4111 14.5520 14.7020 14.7020 14.8455 14.9891 15.1326 15.2761 15.4196 15.5632 15.7067 15.8502 15.9938 16.1373 16.2808 16.4243 16.5679 16.7114 16.8549 16.9985 17.1420 17.2920 17.2920 17.7500 18.2080 18.6660 19.1240 19.2740 19.2740 19.4175 19.5611 19.7046 19.8481 19.9916 20.1352 20.2787 20.4222 20.5658 20.7093 20.8528 20.9963 21.1399 21.2834 21.4269 21.5705 21.7140 21.8640 21.8640 22.0049 22.1458 22.2868 22.4277 22.5686 22.7095 22.8505 22.9914 23.1323 23.2732 23.4142 23.5551 23.6960 23.8460 23.8460 23.9895 24.1331 24.2766 24.4201 24.5636 24.7072 24.8507 24.9942 25.1378 25.2813 25.4248 25.5683 25.7119 25.8554 25.9989 26.1425 26.2860 26.4360 26.4360 26.8940 27.3520 27.8100 28.2680 28.4180 28.4180 28.5615 28.7051 28.8486 28.9921 29.1356 29.2792 29.4227 29.5662 29.7098 29.8533 29.9968 30.1403 30.2839 30.4274 30.5709 30.7145 30.8580 31.0080 31.0080 31.1489 31.2898 31.4308 31.5717 31.7126 31.8535 31.9945 32.1354 32.2763 32.4172 32.5582 32.6991 32.8400 32.9900 32.9900 33.1335 33.2771 33.4206 33.5641 33.7076 33.8512 33.9947 34.1382 34.2818 34.4253 34.5688 34.7123 34.8559 34.9994 35.1429 35.2865 35.4300 35.6070 35.7840 35.7840 35.9191 36.0542 36.1893 36.3244 36.4596 36.5947 36.7298 36.8649 37.0000 37.0000 37.1360 37.2720 37.4080 37.5440 37.6800 37.8160 37.9520 38.0880 38.2240 38.3740 38.3740 38.5240 38.7907 39.1740 39.6740 40.1715 40.6690 41.1664 41.6639 42.1614 42.6589 43.1564 43.6539 44.1513 44.6488 45.1463 45.6438];
mesh.z=[0.0000 0.2500 0.5000 0.7500 1.0000 1.2500 1.5000 -4.0000 -3.3333 -2.6667 -2.0000 -1.3333 -0.6667 1.5000 2.1667 2.8333 3.5000 4.1667 4.8333];
mesh.x = mesh.x .+ offset.x;
mesh.y = offset.y .- mesh.y;
mesh.z = z_bottom_copper .- mesh.z .+ offset.z;
CSX = DefineRectGrid(CSX, unit, mesh);

%%% Layer mapping
layers(1).number = 1;
layers(1).name = 'top_copper';
layers(1).clearn = 0;
layer_types(1).name = 'COPPER_1';
layer_types(1).subtype = 2;
layer_types(1).thickness = 0.0/1000;
layer_types(1).conductivity = 56*10^6;

layers(2).number = 2;
layers(2).name = 'grp_4';
layers(2).clearn = 0;
layer_types(2).name = 'SUBSTRATE_2';
layer_types(2).subtype = 3;
layer_types(2).thickness = 1.5;
layer_types(2).epsilon = 3.66;
layer_types(2).mue = 0;
layer_types(2).kappa = 0;
layer_types(2).sigma = 0;

layers(3).number = 3;
layers(3).name = 'bottom_copper';
layers(3).clearn = 0;
layer_types(3).name = 'COPPER_3';
layer_types(3).subtype = 2;
layer_types(3).thickness = 0.0/1000;
layer_types(3).conductivity = 56*10^6;


%%% Initialize pcb2csx
PCBRND = InitPCBRND(layers, layer_types, void, base_priority, offset, kludge);
CSX = InitPcbrndLayers(CSX, PCBRND);

%%% Board outline
outline_xy(1, 1) = 0; outline_xy(2, 1) = 0;
outline_xy(1, 2) = 45.6438; outline_xy(2, 2) = 0;
outline_xy(1, 3) = 45.6438; outline_xy(2, 3) = -43.1800;
outline_xy(1, 4) = 0; outline_xy(2, 4) = -43.1800;
CSX = AddPcbrndPoly(CSX, PCBRND, 2, outline_xy, 1);

%%% Copper objects
poly0_xy(1, 1) = 44.6278; poly0_xy(2, 1) = -42.1538;
poly0_xy(1, 2) = 1.0160; poly0_xy(2, 2) = -42.1538;
poly0_xy(1, 3) = 1.0160; poly0_xy(2, 3) = -1.0160;
poly0_xy(1, 4) = 44.6278; poly0_xy(2, 4) = -1.0160;
CSX = AddPcbrndPoly(CSX, PCBRND, 3, poly0_xy, 1);
poly1_xy(1, 1) = 35.4800; poly1_xy(2, 1) = -33.0098;
poly1_xy(1, 2) = 32.9400; poly1_xy(2, 2) = -33.0098;
poly1_xy(1, 3) = 32.9400; poly1_xy(2, 3) = -7.6098;
poly1_xy(1, 4) = 30.9080; poly1_xy(2, 4) = -7.6098;
poly1_xy(1, 5) = 30.9080; poly1_xy(2, 5) = -33.0098;
poly1_xy(1, 6) = 28.3680; poly1_xy(2, 6) = -33.0098;
poly1_xy(1, 7) = 28.3680; poly1_xy(2, 7) = -7.6098;
poly1_xy(1, 8) = 30.9080; poly1_xy(2, 8) = -5.0698;
poly1_xy(1, 9) = 32.9400; poly1_xy(2, 9) = -5.0698;
poly1_xy(1, 10) = 35.4800; poly1_xy(2, 10) = -7.6098;
CSX = AddPcbrndPoly(CSX, PCBRND, 1, poly1_xy, 1);
poly2_xy(1, 1) = 19.2240; poly2_xy(2, 1) = -7.6098;
poly2_xy(1, 2) = 21.7640; poly2_xy(2, 2) = -7.6098;
poly2_xy(1, 3) = 21.7640; poly2_xy(2, 3) = -33.0098;
poly2_xy(1, 4) = 23.7960; poly2_xy(2, 4) = -33.0098;
poly2_xy(1, 5) = 23.7960; poly2_xy(2, 5) = -7.6098;
poly2_xy(1, 6) = 26.3360; poly2_xy(2, 6) = -7.6098;
poly2_xy(1, 7) = 26.3360; poly2_xy(2, 7) = -33.0098;
poly2_xy(1, 8) = 23.7960; poly2_xy(2, 8) = -35.5498;
poly2_xy(1, 9) = 21.7640; poly2_xy(2, 9) = -35.5498;
poly2_xy(1, 10) = 19.2240; poly2_xy(2, 10) = -33.0098;
CSX = AddPcbrndPoly(CSX, PCBRND, 1, poly2_xy, 1);
poly3_xy(1, 1) = 17.1920; poly3_xy(2, 1) = -33.0098;
poly3_xy(1, 2) = 14.6520; poly3_xy(2, 2) = -33.0098;
poly3_xy(1, 3) = 14.6520; poly3_xy(2, 3) = -7.6098;
poly3_xy(1, 4) = 12.6200; poly3_xy(2, 4) = -7.6098;
poly3_xy(1, 5) = 12.6200; poly3_xy(2, 5) = -33.0098;
poly3_xy(1, 6) = 10.0800; poly3_xy(2, 6) = -33.0098;
poly3_xy(1, 7) = 10.0800; poly3_xy(2, 7) = -7.6098;
poly3_xy(1, 8) = 12.6200; poly3_xy(2, 8) = -5.0698;
poly3_xy(1, 9) = 14.6520; poly3_xy(2, 9) = -5.0698;
poly3_xy(1, 10) = 17.1920; poly3_xy(2, 10) = -7.6098;
CSX = AddPcbrndPoly(CSX, PCBRND, 1, poly3_xy, 1);
poly4_xy(1, 1) = 9.8260; poly4_xy(2, 1) = -38.0898;
poly4_xy(1, 2) = 7.2860; poly4_xy(2, 2) = -38.0898;
poly4_xy(1, 3) = 7.2860; poly4_xy(2, 3) = -7.6098;
poly4_xy(1, 4) = 9.8260; poly4_xy(2, 4) = -7.6098;
CSX = AddPcbrndPoly(CSX, PCBRND, 1, poly4_xy, 1);
poly5_xy(1, 1) = 38.2740; poly5_xy(2, 1) = -38.0898;
poly5_xy(1, 2) = 35.7340; poly5_xy(2, 2) = -38.0898;
poly5_xy(1, 3) = 35.7340; poly5_xy(2, 3) = -7.6098;
poly5_xy(1, 4) = 38.2740; poly5_xy(2, 4) = -7.6098;
CSX = AddPcbrndPoly(CSX, PCBRND, 1, poly5_xy, 1);
poly6_xy(1, 1) = 8.0500; poly6_xy(2, 1) = -36.5000;
poly6_xy(1, 2) = 9.0500; poly6_xy(2, 2) = -36.5000;
poly6_xy(1, 3) = 9.0500; poly6_xy(2, 3) = -37.5000;
poly6_xy(1, 4) = 8.0500; poly6_xy(2, 4) = -37.5000;
CSX = AddPcbrndPoly(CSX, PCBRND, 1, poly6_xy, 1);
poly7_xy(1, 1) = 36.5000; poly7_xy(2, 1) = -36.5000;
poly7_xy(1, 2) = 37.5000; poly7_xy(2, 2) = -36.5000;
poly7_xy(1, 3) = 37.5000; poly7_xy(2, 3) = -37.5000;
poly7_xy(1, 4) = 36.5000; poly7_xy(2, 4) = -37.5000;
CSX = AddPcbrndPoly(CSX, PCBRND, 1, poly7_xy, 1);
%%% Port(s) on terminals

point1(1, 1) = 8.5500; point1(2, 1) = -37.0000;
[start1, stop1] = CalcPcbrnd2PortV(PCBRND, point1, 1, 3);
[CSX, port{1}] = AddLumpedPort(CSX, 999, 1, 50.000000, start1, stop1, [0 0 -1], true);

point2(1, 1) = 37.0000; point2(2, 1) = -37.0000;
[start2, stop2] = CalcPcbrnd2PortV(PCBRND, point2, 1, 3);
[CSX, port{2}] = AddLumpedPort(CSX, 999, 2, 50.000000, start2, stop2, [0 0 -1]);
